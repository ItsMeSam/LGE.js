function LittleGameEngine(){this.title="LittleGameEngine";this.context=null;this.canvas;this.screen=new Array();this.sprite=new Array();this.background;this.contextmenu=new Array();this.fixed=new Array();this.stuck=false;this.block=false}LittleGameEngine.prototype={constructor:LittleGameEngine,setTitle:function(title){this.title=title},setCanvas:function(canvas){this.canvas=document.getElementById(canvas);this.context=this.canvas.getContext('2d')},setBackground:function(path){this.canvas.style.backgroundImage='url('+path+')'},setContextMenu:function(bool,toshow){toshow=typeof toshow!=='undefined'?toshow:null;this.contextmenu.push(bool);this.contextmenu.push(toshow)},create:function(){document.title=this.title;if(this.context==null){console&&console.warn('No canvas has been set.')}else{this.canvas.height=window.innerHeight;this.canvas.width=window.innerWidth}if(this.contextmenu[0]){if(this.contextmenu[1]!=null){var element=document.getElementById(this.contextmenu[1]);document.addEventListener('contextmenu',function(e){element.style.top=e.clientY+'px';element.style.left=e.clientX+'px';element.style.display='block';e.preventDefault();return false});document.addEventListener('mouseup',function(e){if(e.target!=element&&e.target.parentNode!=element){element.style.display='none'}})}else{document.addEventListener('contextmenu',function(e){e.preventDefault();return false})}}},addScreen:function(name,screen){this.screen[name]=screen},gotoScreen:function(name){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);if(this.screen[name]==undefined){console&&console.warn('Selected screen doesn\'t exist')}else{this.screen[name]()}},addImage:function(path,x,y,w,h){w=typeof w!=='undefined'?w:null;h=typeof h!=='undefined'?h:null;var self=this;var image=new Image();image.src=path;if(w==null&h==null){self.context.drawImage(image,x,y)}else{self.context.drawImage(image,x,y,w,h)}},addSprite:function(name,x,y,w,h,type,path){type=typeof type!=='undefined'?type:'rect';path=typeof path!=='undefined'?path:null;if(type=='rect'){this.context.fillRect(x,y,w,h)}else if(type=='image'){this.addImage(path,x,y,w,h)}else if(type=='text'){this.context.fillText(path,x,y)}this.sprite[name]=new Array();this.sprite[name][0]=x;this.sprite[name][1]=y;this.sprite[name][2]=w;this.sprite[name][3]=h;this.sprite[name][4]=type;this.sprite[name][5]=path},moveSprite:function(name,x,y,movement,w,h,type){w=typeof w!=='undefined'?w:this.sprite[name][2];h=typeof h!=='undefined'?h:this.sprite[name][3];type=typeof type!=='undefined'?type:'rect';for(f in this.fixed){if(this.stuck===false){if(this.sprite[this.fixed[f]][0]<this.sprite[name][0]+this.sprite[name][2]&&this.sprite[this.fixed[f]][0]+this.sprite[this.fixed[f]][2]>this.sprite[name][0]&&this.sprite[this.fixed[f]][1]<this.sprite[name][1]+this.sprite[name][3]&&this.sprite[this.fixed[f]][1]+this.sprite[this.fixed[f]][3]>this.sprite[name][1]){this.stuck=movement;return}}else if(this.stuck!==false&&movement==this.stuck){this.block=true;return}if(this.stuck!==false&&this.block==true&&movement!=this.stuck){this.block=false;this.stuck=false;movement=null}}if(type=='rect'){var path=this.sprite[name][5];this.context.clearRect(0,0,this.canvas.width,this.canvas.height);delete this.sprite[name];for(var i in this.sprite){if(this.sprite[i][4]=='rect'){this.context.fillRect(this.sprite[i][0],this.sprite[i][1],this.sprite[i][2],this.sprite[i][3])}else if(this.sprite[i][4]=='image'){this.addImage(this.sprite[i][5],this.sprite[i][0],this.sprite[i][1],this.sprite[i][2],this.sprite[i][3])}else if(this.sprite[i][4]=='text'){this.context.fillText(this.sprite[i][5],this.sprite[i][0],this.sprite[i][1])}}this.addSprite(name,x,y,w,h)}else if(type=='image'){var path=this.sprite[name][5];this.context.clearRect(0,0,this.canvas.width,this.canvas.height);delete this.sprite[name];for(var i in this.sprite){if(this.sprite[i][4]=='rect'){this.context.fillRect(this.sprite[i][0],this.sprite[i][1],this.sprite[i][2],this.sprite[i][3])}else if(this.sprite[i][4]=='image'){this.addImage(this.sprite[i][5],this.sprite[i][0],this.sprite[i][1],this.sprite[i][2],this.sprite[i][3])}else if(this.sprite[i][4]=='text'){this.context.fillText(this.sprite[i][5],this.sprite[i][0],this.sprite[i][1])}}this.addSprite(name,x,y,w,h,'image',path)}},setFont:function(size,font){this.context.font=size+'px '+font},setColor:function(color){this.context.fillStyle=color},clearCanvas:function(){if(this.context.clearRect(0,0,this.canvas.width,this.canvas.height)&&delete this.sprite){return true}else{return false}},addFixed:function(name){if(this.fixed.push(name)){return true}else{return false}},playSound:function(path){new Audio(path).play()},mouseClick:function(name,e){if(e.clientX>=this.sprite[name][0]&&e.clientX<=this.sprite[name][0]+this.sprite[name][2]&&e.clientY>=this.sprite[name][1]&&e.clientY<=this.sprite[name][1]+this.sprite[name][3]){return true}else{return false}}}
